class Hajimari{constructor(){rend_linepaper=new LineRenderer(glpaper);rend_line=new LineRenderer(gl);rend_fill=new FillRenderer(gl);anima=new AnimationManager(60);if(window.is_mobile){console.log("Mobile device detected, forcing 60 FPS");anima.setFrameRate(60)};ddra=new Draw();paperdraw=new PaperDraw();window.globalScaleFactor=1.0*forMobile_mag;g_pen=new G_pen();g_tume=new G_tume();g_oyayubi=new G_oyayubi();g_hitoyubi=new G_hitoyubi();g_sode=new G_sode();motionpen=new Motionpen();fface=new Face();nnyu=new Nyuryoku();const bluecover=document.getElementById('bluecover');if(bluecover){const hideBluecover=(e)=>{e.preventDefault();e.stopPropagation();bluecover.style.display='none';return!1};['mousedown','touchstart','click'].forEach(eventType=>{bluecover.addEventListener(eventType,hideBluecover,!0)})};cc_inout=0;this.updateCanvasSize();window.addEventListener('resize',()=>{this.updateCanvasSize();this.setupTexture()});this.update=this.update.bind(this);anima.setDrawCallback(this.update);anima.start();document.addEventListener('keydown',(e)=>{if(e.key==='r'||e.key==='R'){}});this.moveShader=new MoveShader(glpaper);this.setupTexture();this.scrolling=!0;this.scrollSpeed=3.0;this.totalScrollY=0};updateCanvasSize(){const windowWidth=window.innerWidth;const windowHeight=window.innerHeight;const aspectRatio=windowWidth/windowHeight;let densityFactor=0.66;if(window.is_mobile)densityFactor=1.0;rend_linepaper.setPixelDensity(densityFactor,windowWidth,windowHeight);rend_line.setPixelDensity(densityFactor,windowWidth,windowHeight);rend_fill.setPixelDensity(densityFactor,windowWidth,windowHeight);if(aspectRatio<1){window.globalScaleFactor=(0.3+aspectRatio*0.7)*forMobile_mag;window.windowTatenagaMag=qb.mppng((0.3+aspectRatio*0.7),0.3,1,1,0,!0,0.0)}else{window.globalScaleFactor=(1.0)*forMobile_mag;window.windowTatenagaMag=0};if(window.is_mobile){console.log("Mobile device detected, applying additional scaling")}};setupTexture(){this.moveTexture=glpaper.createTexture();glpaper.bindTexture(glpaper.TEXTURE_2D,this.moveTexture);glpaper.texImage2D(glpaper.TEXTURE_2D,0,glpaper.RGBA,canvaspaper.width,canvaspaper.height,0,glpaper.RGBA,glpaper.UNSIGNED_BYTE,null);glpaper.texParameteri(glpaper.TEXTURE_2D,glpaper.TEXTURE_MIN_FILTER,glpaper.NEAREST);glpaper.texParameteri(glpaper.TEXTURE_2D,glpaper.TEXTURE_MAG_FILTER,glpaper.NEAREST);glpaper.texParameteri(glpaper.TEXTURE_2D,glpaper.TEXTURE_WRAP_S,glpaper.CLAMP_TO_EDGE);glpaper.texParameteri(glpaper.TEXTURE_2D,glpaper.TEXTURE_WRAP_T,glpaper.CLAMP_TO_EDGE)};update(deltaTime){cc+=1;if(cc_inout<1)cc_inout+=0.013;else cc_inout=1;this.shiftDrawingUp(this.scrollSpeed);if(paperdraw){paperdraw.updateScrollOffset(this.totalScrollY)};motionpen.fef();g_pen.fef();g_oyayubi.fef();g_hitoyubi.fef();g_sode.fef();g_tume.fef();fface.fef();paperdraw.fef();ddra.fef()};shiftDrawingUp(speed){const height=canvaspaper.height;glpaper.bindTexture(glpaper.TEXTURE_2D,this.moveTexture);glpaper.copyTexImage2D(glpaper.TEXTURE_2D,0,glpaper.RGBA,0,0,canvaspaper.width,canvaspaper.height,0);glpaper.clear(glpaper.COLOR_BUFFER_BIT);this.moveShader.draw(this.moveTexture,0,-speed);this.totalScrollY+=speed}};window.addEventListener('unload',()=>{anima.stop();rend_linepaper.dispose();rend_line.dispose();rend_fill.dispose()})